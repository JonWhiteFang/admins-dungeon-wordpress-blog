# Project Structure

## Directory Organization

```
.
├── .kiro/
│   ├── settings/
│   │   └── mcp.json                    # MCP server configuration
│   ├── specs/
│   │   └── lightsail-wordpress-deployment/
│   │       ├── requirements.md         # Functional requirements
│   │       ├── design.md              # Architecture and design
│   │       └── tasks.md               # Implementation tasks
│   └── steering/
│       ├── mcp-server-usage.md        # MCP usage guidelines
│       ├── product.md                 # Product overview
│       ├── tech.md                    # Tech stack and commands
│       └── structure.md               # This file
├── lightsail-wordpress.yaml           # CloudFormation template (to be created)
├── scripts/                           # Automation scripts (to be created)
│   ├── deploy-stack.sh
│   ├── get-outputs.sh
│   ├── configure-ssl.sh
│   ├── install-security-plugins.sh
│   ├── install-caching.sh
│   ├── enable-snapshots.sh
│   ├── daily-health-check.sh
│   └── verify-backups.sh
└── lightsail-wordpress-deployment-prompt.md  # Original deployment guide
```

## Key Files

### CloudFormation Template
- **lightsail-wordpress.yaml**: Main infrastructure definition
  - Parameters: Instance configuration (name, size, zone, domain, email)
  - Resources: Lightsail instance, static IP, DNS zone, SSL certificate
  - Outputs: URLs, IP addresses, SSH commands, next steps

### Automation Scripts
- **deploy-stack.sh**: Creates CloudFormation stack with parameters
- **get-outputs.sh**: Retrieves and displays stack outputs
- **configure-ssl.sh**: Configures Let's Encrypt SSL via bncert-tool
- **install-security-plugins.sh**: Installs Wordfence, Limit Login Attempts, UpdraftPlus
- **install-caching.sh**: Installs and configures WP Super Cache, Smush, Redis
- **enable-snapshots.sh**: Enables automatic daily snapshots
- **daily-health-check.sh**: Checks instance state and CPU metrics
- **verify-backups.sh**: Lists recent snapshots for verification

### Specification Files
- **requirements.md**: 15 functional requirements with acceptance criteria
- **design.md**: Architecture diagrams, component descriptions, data models
- **tasks.md**: 20 implementation tasks mapped to requirements

## Naming Conventions

### CloudFormation Resources
- Stack name: `wordpress-blog-prod`
- Instance name: `wordpress-blog-prod-eu-west-2`
- Static IP: `{InstanceName}-static-ip`
- SSL certificate: `{InstanceName}-ssl-cert`

### Snapshots
- Automatic: Generated by Lightsail with timestamp
- Manual: `wordpress-{purpose}-YYYYMMDD` (e.g., `wordpress-baseline-20251022`)

### Scripts
- Use kebab-case: `script-name.sh`
- Prefix with action: `deploy-`, `install-`, `enable-`, `verify-`

## Configuration Locations

### AWS Resources
- Region: `eu-west-2` (London)
- Availability zones: `eu-west-2a`, `eu-west-2b`, `eu-west-2c`

### Instance Paths
- WordPress root: `/opt/bitnami/wordpress/`
- WordPress config: `/opt/bitnami/wordpress/wp-config.php`
- Backup directory: `/opt/bitnami/backups/`
- Admin password: `/home/bitnami/bitnami_application_password`
- Initialization log: `/var/log/wordpress-init.log`
- Cloud-init log: `/var/log/cloud-init-output.log`

### PHP Configuration
- PHP config: `/opt/bitnami/php/etc/php.ini`
- Key settings: memory_limit (256M), upload_max_filesize (64M), post_max_size (64M), max_execution_time (300s)

### Apache Configuration
- Apache config: `/opt/bitnami/apache2/conf/`
- Control script: `/opt/bitnami/ctlscript.sh`
